<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.kosa.realestate.realestates.repository.IRealEstateDetailRepository">
	   
	<resultMap type="RealEstateWithSale" id="RealEstateWithSaleMap">
		<association property="realEstate" javaType="RealEstate">
	        <id property="realEstateId" column="REAL_ESTATE_ID"/>
	        <result property="neighborhoodId" column="NEIGHBORHOOD_ID"/>
	        <result property="complexName" column="COMPLEX_NAME"/>
	        <result property="address" column="ADDRESS"/>
	        <result property="addressStreet"  column="ADDRESS_STREET"/>
	        <result property="constructionYear" column="CONSTRUCTION_YEAR"/>
	        <result property="lat" column="LAT"/>
	        <result property="lng" column="LNG"/>
	        <!-- <result property="buildingFlag" column="BUILDING_FLAG"/> -->
	    </association>
	    <association property="realEstateSale" javaType="RealEstateSale">
	        <id property="salesId" column="SALES_ID"/>
	        <result property="realEstateId" column="REAL_ESTATE_ID"/>
	        <result property="salePrice" column="SALE_PRICE"/>
	        <result property="contractDate" column="CONTRACT_DATE"/>
	        <result property="registrationDate" column="REGISTRATION_DATE" />
	        <result property="buildingName" column="BUILDING_NAME"/>
	        <result property="floor" column="FLOOR"/>
	        <result property="exclusiveArea" column="EXCLUSIVE_AREA"/>
	    </association>
	</resultMap>
	
	<select id="getRealEstateDetail" parameterType="int" resultMap="RealEstateWithSaleMap">
	    SELECT 
	        RS.SALES_ID,
	        RE.REAL_ESTATE_ID,
	        RE.NEIGHBORHOOD_ID,
	        RE.COMPLEX_NAME,
	        RE.ADDRESS,
	        RE.ADDRESS_STREET,
	        RE.CONSTRUCTION_YEAR,
	        RE.LAT,
	        RE.LNG,
	        RS.SALE_PRICE,
	        RS.CONTRACT_DATE,
	        <!-- NVL(TO_CHAR(RS.REGISTRATION_DATE, 'YYYY-MM-DD'), ' ') AS REGISTRATION_DATE, -->
	        RS.REGISTRATION_DATE,
	        RS.BUILDING_NAME,
	        RS.FLOOR,
	        RS.EXCLUSIVE_AREA
	    FROM 
	        REAL_ESTATE_SALE RS
	        JOIN REAL_ESTATE RE ON RS.REAL_ESTATE_ID = RE.REAL_ESTATE_ID
	    WHERE 
	        RS.SALES_ID = #{salesId}
	</select>

 
</mapper>